"use strict";var Wt=Object.create;var Y=Object.defineProperty;var zt=Object.getOwnPropertyDescriptor;var Bt=Object.getOwnPropertyNames;var Vt=Object.getPrototypeOf,$t=Object.prototype.hasOwnProperty;var Ut=(i,t)=>{for(var e in t)Y(i,e,{get:t[e],enumerable:!0})},ft=(i,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Bt(t))!$t.call(i,r)&&r!==e&&Y(i,r,{get:()=>t[r],enumerable:!(n=zt(t,r))||n.enumerable});return i};var Ft=(i,t,e)=>(e=i!=null?Wt(Vt(i)):{},ft(t||!i||!i.__esModule?Y(e,"default",{value:i,enumerable:!0}):e,i)),Zt=i=>ft(Y({},"__esModule",{value:!0}),i);var ve={};Ut(ve,{TvmConnectUI:()=>mt,everWallet:()=>lt,everscaleConnection:()=>le,everscaleNetwork:()=>se,hamsterConnection:()=>he,hamsterNetwork:()=>ce,sparxWallet:()=>nt,tonConnection:()=>fe,tonNetwork:()=>pe,tychoTestnetConnection:()=>me,tychoTestnetNetwork:()=>de,venomConnection:()=>ue,venomNetwork:()=>ae,venomWallet:()=>ut});module.exports=Zt(ve);var h=require("lit-html"),Dt=require("lit-html/directives/if-defined.js"),ht=require("lit-html/directives/class-map.js"),Ot=require("everscale-inpage-provider");var x=require("mobx"),X=function(i,t,e,n){var r=arguments.length,o=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(i,t,e,n);else for(var u=i.length-1;u>=0;u--)(a=i[u])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},M=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},_=class{_data={};_state={};constructor(t){(0,x.makeObservable)(this,void 0,t)}setData(t,e){return typeof t=="function"?(this._data=t({...this._data}),this):typeof t=="string"?(this._data={...this._data,[t]:e},this):(typeof t=="object"&&!Array.isArray(t)&&(this._data={...this._data,...t}),this)}setState(t,e){return typeof t=="function"?(this._state=t({...this._state}),this):typeof t=="string"?(this._state={...this._state,[t]:e},this):(typeof t=="object"&&!Array.isArray(t)&&(this._state={...this._state,...t}),this)}toJSON(){return(0,x.toJS)(this._data)}};X([x.observable,M("design:type",Object)],_.prototype,"_data",void 0);X([x.observable,M("design:type",Object)],_.prototype,"_state",void 0);X([x.action.bound,M("design:type",Function),M("design:paramtypes",[Object,Object]),M("design:returntype",Object)],_.prototype,"setData",null);X([x.action.bound,M("design:type",Function),M("design:paramtypes",[Object,Object]),M("design:returntype",Object)],_.prototype,"setState",null);var k;(function(i){i[i.EverscaleMainnet=42]="EverscaleMainnet",i[i.VenomMainnet=1]="VenomMainnet",i[i.VenomTestnet=1e3]="VenomTestnet",i[i.TychoTestnet=2e3]="TychoTestnet"})(k||(k={}));var vt;(function(i){i.ASCENDING="ASC",i.DESCENDING="DESC"})(vt||(vt={}));var gt="#3e8c3e",yt="#fab254",wt="#d33131";function H(i="inherit"){return` background-color: ${i}50; border-left: 3px solid ${i}; border-radius: 2px; display: inline; font-size: 1em; font-weight: bold; line-height: 1rem; padding: 3px 4px 0 4px`}var Ie=H("#767676"),Q=H(gt),q=H(yt),K=H(wt),W=`color: ${gt}; display: inline; font-weight: 400;`,Ee=`color: ${yt}; display: inline; font-weight: 400;`,Se=`color: ${wt}; display: inline; font-weight: 400;`,C="color: inherit; display: inline; font-weight: 400;";var ot=require("everscale-inpage-provider"),Ae=new ot.AddressLiteral("0:0000000000000000000000000000000000000000000000000000000000000000"),Pe=new ot.AddressLiteral("0:000000000000000000000000000000000000000000000000000000000000dead");var J=9;var _e=3.1536*10**7;var je=require("@broxus/js-utils");var rt=require("everscale-inpage-provider");var bt=require("everscale-inpage-provider");function It(i,t=!0){return i==null?!1:i instanceof bt.Address?!0:typeof i=="string"?t?/^(?:0|-1):[0-9a-fA-F]{64}$/.test(i):/^0:[0-9a-fA-F]{64}$/.test(i):!1}function L(i){if(i instanceof rt.Address)return i;if(!It(i))throw new Error(`${i} is not a TVM-like address`);return new rt.Address(i)}var tt=new Map,Gt=10*1e3;async function Et(i,t,e){let n=t.toString().toLowerCase();try{let r=tt.get(n);if(r&&!e?.force){let a=e?.ttl??Gt,{state:u,timestamp:T}=r;if(Date.now()-T<a&&u)return await u}let o=i.getFullContractState({address:L(t)}).then(a=>a.state).catch(a=>{throw tt.delete(n),a});return tt.set(n,{state:o,timestamp:Date.now()}),await o}catch{tt.delete(n);return}}function z(i,t){return i!==void 0&&i?.toString().toLowerCase()===t?.toString().toLowerCase()}var Ct=require("everscale-inpage-provider");var w=require("@broxus/js-utils"),B=require("everscale-inpage-provider"),R=require("mobx");var g=require("@broxus/js-utils"),f=require("mobx"),y=function(i,t,e,n){var r=arguments.length,o=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(i,t,e,n);else for(var u=i.length-1;u>=0;u--)(a=i[u])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},c=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},m=class extends _{params;provider;constructor(t){super(),this.params=t,(0,f.makeObservable)(this)}async connect(t){if(!this.provider)throw new Error("Provider is not defined");try{this.setState("isConnecting",!0),await this.provider.hasProvider();let e=await(0,g.timeoutPromise)(this.provider.getProviderState(),2e3).catch(()=>{});if(e?.permissions.accountInteraction){this.setData({account:e.permissions.accountInteraction,chainId:Math.abs(e.networkId),version:e.version}),this.setState({isConnecting:!1,isInitialized:!0});return}await this.stopSubscriptions(),await this.runSubscriptions();let n=await this.provider.requestPermissions({permissions:["basic","accountInteraction"]});this.setData("account",n.accountInteraction),e=await(0,g.timeoutPromise)(this.provider.getProviderState(),2e3);let r=Math.abs(e.networkId),o=typeof t=="number"?t:t?.networkId,a=this.params?.info?.name??this.constructor.name??this.constructor.prototype.name;if(!o||r===o){this.setData({chainId:Math.abs(e.networkId),version:e.version}),this.setState({isConnecting:!1,isInitialized:!0}),(0,g.debug)(`${a} connection has skipped network switching.`);return}if(!t){(0,g.debug)(`${a} connection has skipped network switching. Chain params or chainId is not provided.`);return}(0,g.debug)(`${a} connection trying to switch network.`),await this.switchNetwork(t).then(async()=>{await this.connect(t)}).catch(async()=>{await this.connect()})}catch(e){throw this.setState("isConnecting",!1),await this.stopSubscriptions(),e}}async disconnect(t){if(!((this.isConnecting||this.isDisconnecting)&&!t))try{this.setState("isDisconnecting",!0),await this.provider?.disconnect(),await this.stopSubscriptions(),this.setData(()=>({}))}catch(e){(0,g.groupCollapsed)(`%c${this.constructor.name}%c Wallet disconnecting error`,K,C),(0,g.error)(e),(0,g.groupEnd)()}finally{this.setState("isDisconnecting",!1)}}async addAsset(t,e="tip3_token"){if(!this.provider)throw new Error("Provider is not defined");if(!this.account?.address)throw new Error("No connected account");return(await this.provider.addAsset({account:this.account.address,params:{rootContract:L(t)},type:e})).newAsset}async addNetwork(t,e){if(!this.provider)throw new Error("Provider is not defined");return(await this.provider.addNetwork({network:t,switchNetwork:e})).network}async switchNetwork(t){if(!this.provider)throw new Error("Provider is not defined");let e=typeof t=="number"?t:t.networkId,n=await this.provider.changeNetwork({networkId:e});return n.network==null&&typeof t!="number"&&(n.network=await this.addNetwork(t,!0)),n.network}get account(){return this._data.account}get chainId(){return this._data.chainId}get version(){return this._data.version}get isConnecting(){return this._state.isConnecting}get isDisconnecting(){return this._state.isDisconnecting}get isInitialized(){return this._state.isInitialized}get isInitializing(){return this._state.isInitializing}async handlePermissionsChanged(t){let e=t.permissions.accountInteraction;if(!e){(0,g.debug)(`%c${this.constructor.name}%c Permissions have been revoked. Disconnect dApp!`,q,C),await this.disconnect();return}z(this.account?.address,e.address)||(this.setData("account",e),(0,g.debug)(`%c${this.constructor.name}%c Permissions have been changed`,q,C))}async handleNetworkChanged(t){let e=Math.abs(t.networkId);this.chainId!==e&&((0,g.debug)(`%c${this.constructor.name}%c Network has been changed from ${this.chainId} to ${e}`,q,C),this.setData("chainId",e))}handleDisconnected(t){this.setData(()=>({})),this.params?.onDisconnect?.(t)}async runSubscriptions(){(0,g.debug)("runSubscriptions",this.constructor.name);let[t,e]=await Promise.all([this.provider?.subscribe("networkChanged"),this.provider?.subscribe("permissionsChanged")]);this.networkChangeSubscription=t,this.permissionsSubscription=e,this.networkChangeSubscription?.on("data",(0,g.debounce)(this.handleNetworkChanged,400)),this.permissionsSubscription?.on("data",(0,g.debounce)(this.handlePermissionsChanged,400))}async stopSubscriptions(){await Promise.allSettled([this.networkChangeSubscription?.unsubscribe(),this.permissionsSubscription?.unsubscribe()]),this.networkChangeSubscription=void 0,this.permissionsSubscription=void 0}networkChangeSubscription;permissionsSubscription};y([f.observable,c("design:type",Function)],m.prototype,"provider",void 0);y([f.action.bound,c("design:type",Function),c("design:paramtypes",[Object]),c("design:returntype",Promise)],m.prototype,"connect",null);y([f.action.bound,c("design:type",Function),c("design:paramtypes",[Boolean]),c("design:returntype",Promise)],m.prototype,"disconnect",null);y([f.action.bound,c("design:type",Function),c("design:paramtypes",[Object,String]),c("design:returntype",Promise)],m.prototype,"addAsset",null);y([f.action.bound,c("design:type",Function),c("design:paramtypes",[Object,Boolean]),c("design:returntype",Promise)],m.prototype,"addNetwork",null);y([f.action.bound,c("design:type",Function),c("design:paramtypes",[Object]),c("design:returntype",Promise)],m.prototype,"switchNetwork",null);y([f.computed,c("design:type",Object),c("design:paramtypes",[])],m.prototype,"account",null);y([f.computed,c("design:type",Object),c("design:paramtypes",[])],m.prototype,"chainId",null);y([f.computed,c("design:type",Object),c("design:paramtypes",[])],m.prototype,"version",null);y([f.computed,c("design:type",Object),c("design:paramtypes",[])],m.prototype,"isConnecting",null);y([f.computed,c("design:type",Object),c("design:paramtypes",[])],m.prototype,"isDisconnecting",null);y([f.computed,c("design:type",Object),c("design:paramtypes",[])],m.prototype,"isInitialized",null);y([f.computed,c("design:type",Object),c("design:paramtypes",[])],m.prototype,"isInitializing",null);y([f.action.bound,c("design:type",Function),c("design:paramtypes",[Object]),c("design:returntype",Promise)],m.prototype,"handlePermissionsChanged",null);y([f.action.bound,c("design:type",Function),c("design:paramtypes",[Object]),c("design:returntype",Promise)],m.prototype,"handleNetworkChanged",null);y([f.action.bound,c("design:type",Function),c("design:paramtypes",[Error]),c("design:returntype",void 0)],m.prototype,"handleDisconnected",null);y([f.action.bound,c("design:type",Function),c("design:paramtypes",[]),c("design:returntype",Promise)],m.prototype,"runSubscriptions",null);y([f.action.bound,c("design:type",Function),c("design:paramtypes",[]),c("design:returntype",Promise)],m.prototype,"stopSubscriptions",null);var N;(function(i){i.NEKOTON_WALLET="NEKOTON_WALLET",i.NEKOTON_ADAPTER="NEKOTON_ADAPTER",i.EXTERNAL_APP="EXTERNAL_APP"})(N||(N={}));var A;(function(i){i.SPARX_WALLET="com.sparxwallet",i.SPARX_WALLET_MOBILE="com.broxus.sparx.app",i.EVER_WALLET="net.everwallet",i.EVER_WALLET_MOBILE="com.broxus.crystal.app",i.VENOM_WALLET="com.venomwallet",i.VENOM_WALLET_MOBILE="com.venom.wallet"})(A||(A={}));var E;(function(i){i.REQUEST_PROVIDER="tvm:requestProvider",i.ANNOUNCE_PROVIDER="tvm:announceProvider"})(E||(E={}));var Yt=function(i,t,e,n){var r=arguments.length,o=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(i,t,e,n);else for(var u=i.length-1;u>=0;u--)(a=i[u])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},st=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},Xt=i=>async t=>new Promise((e,n)=>{if(t)e(t);else{let r=i?.fallbackAttempts??5,o=0,a=(0,w.debounce)(()=>{if(o>=r){n(new Error(`Max attempts (${r}) is reached.`));return}if((0,w.isBrowser)()&&window.__ever){(0,w.debug)("EVER Wallet provider was found with fallback",window.__ever),e(window.__ever);return}o+=1,a()},1e3);a()}}),Ht=[A.EVER_WALLET.toString(),A.EVER_WALLET_MOBILE.toString()],V=class extends m{params;name="EverWallet";type=N.NEKOTON_WALLET;constructor(t){super(t),this.params=t,(0,R.makeObservable)(this),(t?.autoInit??!0)&&this.init().catch(w.error)}async init(){let t,e=async n=>{let{name:r,rdns:o}=n.detail.info;(r==="EVER Wallet"||o&&Ht.includes(o))&&(window.removeEventListener(E.ANNOUNCE_PROVIDER,e),t=new B.ProviderRpcClient({provider:new B.StaticProviderAdapter(n.detail.provider)}),(0,w.debug)("EVER Wallet provider event was captured",n))};try{if(this.setState("isInitializing",!0),(0,w.isBrowser)()&&(window.addEventListener(E.ANNOUNCE_PROVIDER,e),window.dispatchEvent(new Event(E.REQUEST_PROVIDER))),!t)if(this.params?.fallbackProviderFactory)t=await this.params.fallbackProviderFactory();else{let o=await this.params?.options?.provider??await Xt({fallbackAttempts:this.params?.fallbackAttempts})();o||(0,w.throwException)("No provider found"),t=new B.ProviderRpcClient({provider:o})}await t.hasProvider()||(0,w.throwException)("No provider found"),(0,R.runInAction)(()=>{this.provider=t,(0,w.isBrowser)()&&window.removeEventListener(E.ANNOUNCE_PROVIDER,e)});let r=await(0,w.timeoutPromise)(t.getProviderState(),2e3);r.permissions.accountInteraction||(0,w.throwException)("No permissions returned"),this.setData({account:r.permissions.accountInteraction,chainId:Math.abs(r.networkId),version:r.version}),this.setState({isInitialized:!0,isInitializing:!1}),await this.runSubscriptions()}catch(n){(0,w.debug)("Ever Wallet could not be pre-connected",n),this.setState({isInitialized:!1,isInitializing:!1}),await this.stopSubscriptions()}return this.provider}};Yt([R.action.bound,st("design:type",Function),st("design:paramtypes",[]),st("design:returntype",Promise)],V.prototype,"init",null);var b=require("@broxus/js-utils"),$=require("everscale-inpage-provider"),D=require("mobx");var Qt=function(i,t,e,n){var r=arguments.length,o=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(i,t,e,n);else for(var u=i.length-1;u>=0;u--)(a=i[u])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},at=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},qt=i=>async t=>new Promise((e,n)=>{if(t)e(t);else{let r=i?.fallbackAttempts??5,o=0,a=(0,b.debounce)(()=>{if(o>=r){n(new Error(`Max attempts (${r}) is reached.`));return}if((0,b.isBrowser)()&&window.__sparx){(0,b.debug)("SparX Wallet provider was found with fallback",window.__sparx),e(window.__sparx);return}o+=1,a()},1e3);a()}}),Kt=[A.SPARX_WALLET.toString(),A.SPARX_WALLET_MOBILE.toString()],U=class extends m{params;name="SparXWallet";type=N.NEKOTON_WALLET;constructor(t){super(t),this.params=t,(0,D.makeObservable)(this),(t?.autoInit??!0)&&this.init().catch(b.error)}async init(){let t,e=async n=>{let{name:r,rdns:o}=n.detail.info;(r==="SparX Wallet"||o&&Kt.includes(o))&&(window.removeEventListener(E.ANNOUNCE_PROVIDER,e),t=new $.ProviderRpcClient({provider:new $.StaticProviderAdapter(n.detail.provider)}),(0,b.debug)("SparX Wallet provider event was captured",n))};try{if(this.setState("isInitializing",!0),(0,b.isBrowser)()&&(window.addEventListener(E.ANNOUNCE_PROVIDER,e),window.dispatchEvent(new Event(E.REQUEST_PROVIDER))),!t)if(this.params?.fallbackProviderFactory)t=await this.params.fallbackProviderFactory();else{let o=await this.params?.options?.provider??await qt({fallbackAttempts:this.params?.fallbackAttempts})();o||(0,b.throwException)("No provider found"),t=new $.ProviderRpcClient({provider:o})}await t.hasProvider()||(0,b.throwException)("No provider found"),(0,D.runInAction)(()=>{this.provider=t,(0,b.isBrowser)()&&window.removeEventListener(E.ANNOUNCE_PROVIDER,e)});let r=await(0,b.timeoutPromise)(t.getProviderState(),2e3);r.permissions.accountInteraction||(0,b.throwException)("No permissions returned"),this.setData({account:r.permissions.accountInteraction,chainId:Math.abs(r.networkId),version:r.version}),this.setState({isInitialized:!0,isInitializing:!1}),await this.runSubscriptions()}catch(n){(0,b.debug)("SparX Wallet could not be pre-connected",n),this.setState({isInitialized:!1,isInitializing:!1}),await this.stopSubscriptions()}return this.provider}};Qt([D.action.bound,at("design:type",Function),at("design:paramtypes",[]),at("design:returntype",Promise)],U.prototype,"init",null);var I=require("@broxus/js-utils"),F=require("everscale-inpage-provider"),O=require("mobx");var Jt=function(i,t,e,n){var r=arguments.length,o=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(i,t,e,n);else for(var u=i.length-1;u>=0;u--)(a=i[u])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},ct=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},te=i=>async t=>new Promise((e,n)=>{if(t)e(t);else{let r=i?.fallbackAttempts??5,o=0,a=(0,I.debounce)(()=>{if(o>=r){n(new Error(`Max attempts (${r}) is reached.`));return}if((0,I.isBrowser)()&&window.__venom){(0,I.debug)("Venom Wallet provider was found with fallback",window.__venom),e(window.__venom);return}o+=1,a()},1e3);a()}}),ee=[A.VENOM_WALLET.toString(),A.VENOM_WALLET_MOBILE.toString()],Z=class extends m{params;name="VenomWallet";type=N.NEKOTON_WALLET;constructor(t){super(t),this.params=t,(0,O.makeObservable)(this),(t?.autoInit??!0)&&this.init().catch(I.error)}async init(){let t,e=async n=>{let{name:r,rdns:o}=n.detail.info;(r==="Venom Wallet"||o&&ee.includes(o))&&(window.removeEventListener(E.ANNOUNCE_PROVIDER,e),t=new F.ProviderRpcClient({provider:new F.StaticProviderAdapter(n.detail.provider)}),(0,I.debug)("Venom Wallet provider event was captured",n))};try{if(this.setState("isInitializing",!0),(0,I.isBrowser)()&&(window.addEventListener(E.ANNOUNCE_PROVIDER,e),window.dispatchEvent(new Event(E.REQUEST_PROVIDER))),!t)if(this.params?.fallbackProviderFactory)t=await this.params.fallbackProviderFactory();else{let o=await this.params?.options?.provider??await te({fallbackAttempts:this.params?.fallbackAttempts})();o||(0,I.throwException)("No provider found"),t=new F.ProviderRpcClient({provider:o})}await t.hasProvider()||(0,I.throwException)("No provider found"),(0,O.runInAction)(()=>{this.provider=t,(0,I.isBrowser)()&&window.removeEventListener(E.ANNOUNCE_PROVIDER,e)});let r=await(0,I.timeoutPromise)(t.getProviderState(),2e3);r.permissions.accountInteraction||(0,I.throwException)("No permissions returned"),this.setData({account:r.permissions.accountInteraction,chainId:Math.abs(r.networkId),version:r.version}),this.setState({isInitialized:!0,isInitializing:!1}),await this.runSubscriptions()}catch(n){(0,I.debug)("Venom Wallet could not be pre-connected",n),this.setState({isInitialized:!1,isInitializing:!1}),await this.stopSubscriptions()}return this.provider}};Jt([O.action.bound,ct("design:type",Function),ct("design:paramtypes",[]),ct("design:returntype",Promise)],Z.prototype,"init",null);var et="TVM_RECENT_CONNECTION";var St="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIwMCIgaGVpZ2h0PSIxMjAwIiB2aWV3Qm94PSIwIDAgMTIwMCAxMjAwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogICAgPHBhdGggZD0iTTAgNjAwQzAgMjY4LjYyOSAyNjguNjMgMCA2MDAgMEM5MzEuMzczIDAgMTIwMCAyNjguNjI5IDEyMDAgNjAwQzEyMDAgOTMxLjM3MyA5MzEuMzczIDEyMDAgNjAwIDEyMDBDMjY4LjYzIDEyMDAgMCA5MzEuMzczIDAgNjAwWiIgZmlsbD0idXJsKCNwYWludDBfbGluZWFyXzQyNF8zKSIvPgogICAgPHBhdGggZD0iTTQ1OS4zIDMwMEwxODcuNSA1NzQuNzkySDYyOS4zMjFWMTAxMi41TDkwMCA3NDEuNjM0VjMwMEg0NTkuM1oiIGZpbGw9IndoaXRlIi8+CiAgICA8ZGVmcz4KICAgICAgICA8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50MF9saW5lYXJfNDI0XzMiIHgxPSIxMjAwIiB5MT0iLTAuMDAwMTI5NTI5IiB4Mj0iMTA5LjEyMyIgeTI9IjEwODIuMjYiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KICAgICAgICAgICAgPHN0b3Agc3RvcC1jb2xvcj0iI0ZGNjkyMiIvPgogICAgICAgICAgICA8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM2MzQ3RjUiLz4KICAgICAgICA8L2xpbmVhckdyYWRpZW50PgogICAgPC9kZWZzPgo8L3N2Zz4K";var Je={chainId:k.EverscaleMainnet.toString(),currency:{decimals:J,icon:St,name:"Native currency",symbol:"EVER",wrappedCurrencyAddress:new Ct.AddressLiteral("0:a49cd4e158a9a15555e624759e2e4e766d22600b7800d891e46f9291f044a93d")},explorer:{accountsSubPath:"accounts",baseUrl:"https://everscan.io",title:"EVERScan",transactionsSubPath:"transactions"},icon:St,id:`tvm-${k.EverscaleMainnet.toString()}`,name:"Everscale",rpcUrl:"https://jrpc.everwallet.net",shortName:"Everscale",type:"tvm"};var j=require("@broxus/js-utils"),At=Ft(require("react"));function ie(i){let t={providerId:i.providerId,type:i.type};return!!(t.type&&N[t.type]&&t.providerId)}function dt(i){if(!i){j.storage.remove(et);return}(0,j.debug)("Store TVM recent connection",i),j.storage.set(et,JSON.stringify(i))}function it(){let i=j.storage.get(et);if(i){try{let t=JSON.parse(i);if(ie(t))return t}catch(t){(0,j.debug)(t)}dt(void 0)}}function Pt(i){return{config:{explorerBaseUrl:i.explorer.baseUrl,symbol:i.currency.symbol},connection:{data:{endpoint:i.rpcUrl},type:"proto"},name:i.name,networkId:Number(i.chainId)}}var v=require("@broxus/js-utils");function _t(i){let[t]=Array.from(new Map([["android",(0,v.isMobile)((0,v.getUserAgent)())&&(0,v.isAndroid)((0,v.getUserAgent)())],["ios",(0,v.isMobile)((0,v.getUserAgent)())&&(0,v.isIos)((0,v.getUserAgent)())],["chromeExtension",(0,v.isBrowser)()&&(0,v.isChrome)((0,v.getUserAgent)())],["firefoxExtension",(0,v.isBrowser)()&&(0,v.isFirefox)((0,v.getUserAgent)())]])).find(([,e])=>e)??[];return t?[t,i[t]]:void 0}function xt(i){return/(EverWalletBrowser|EverWallet)/g.test(i)}function Nt(i){return/(SparXWalletBrowser|SparXWallet)/g.test(i)}function Mt(i){return/(VenomWalletBrowser|VenomWallet)/g.test(i)}var S=require("@broxus/js-utils"),pt=require("everscale-inpage-provider"),d=require("mobx");var l=function(i,t,e,n){var r=arguments.length,o=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(i,t,e,n);else for(var u=i.length-1;u>=0;u--)(a=i[u])&&(o=(r<3?a(o):r>3?a(t,e,o):a(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},s=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},p=class extends _{params;name="TvmWalletService";constructor(t){super(),this.params=t,this.setData(()=>({networks:t?.networks||[]}));let e=t?.providers?.some(n=>n.id===t.providerId);this.setState(()=>({isSyncing:void 0,providerId:e?t?.providerId:void 0})),(0,d.makeObservable)(this),(t?.autoInit??!0)&&this._init().catch(n=>{(0,S.error)("Wallet init failed with an error",n)})}get connector(){return this.providers?.find(t=>t.id===this.providerId)?.connector}async init(){let t=await this.connector?.init();return await this._init(),t}async connect(t){if(!(this.isConnecting||this.isDisconnecting))try{let e=typeof t=="number"?t:t?.networkId??this.params?.defaultNetworkId??this.network?.chainId??k.EverscaleMainnet,n=this.networks.find(o=>o.chainId===e?.toString()),r=typeof t=="object"?t:n?Pt(n):void 0;await this.connector?.connect(r??k.EverscaleMainnet)}catch(e){throw(0,S.error)("Tvm Wallet connect error",e),e}}async disconnect(t){if(!((this.isConnecting||this.isDisconnecting)&&!t))try{await this.connector?.disconnect(),this.setData("contractState",void 0)}catch(e){(0,S.error)("TVM Wallet disconnect error",e)}}async addAsset(t,e="tip3_token"){return this.connector?.addAsset(t,e)}async addNetwork(t,e){if(!this.connector)throw new Error("Provider is not defined");return this.connector.addNetwork(t,e)}async switchNetwork(t){if(!this.connector)throw new Error("Provider is not defined");return this.connector.switchNetwork(t)}get connection(){let t=this.params?.connectionParams;return t?.factory?.(this.network)??new pt.ProviderRpcClient({provider:t?.provider})}get provider(){return this.connector?.provider}get contract(){return this._data.contractState}get networks(){return this._data.networks}get isSyncing(){return this._state.isSyncing}get providerId(){return this._state.providerId}get address(){return this.account?.address}get balance(){return this.contract?.balance??"0"}get currency(){return{decimals:this.network?.currency.decimals??J,icon:this.network?.currency.icon,name:this.network?.currency.name,symbol:this.network?.currency.symbol||"EVER",wrappedCurrencyAddress:this.network?.currency.wrappedCurrencyAddress?L(this.network.currency.wrappedCurrencyAddress):void 0}}get hasProvider(){return this.connector?.provider!=null}get isConnected(){return this.address!==void 0}get isOutdated(){let t=this.params?.providers?.find(T=>T.id===this.providerId);if(this.connector?.version===void 0||t?.minVersion===void 0)return!1;let[e="0",n="0",r="0"]=this.connector.version.split("."),[o,a,u]=t.minVersion.split(".");return e<o||e<=o&&n<a||e<=o&&n<=a&&r<u}get isReady(){return!this.isInitializing&&!this.isConnecting&&!this.isDisconnecting&&this.isInitialized===!0&&this.isConnected}get isUnsupportedNetwork(){return this.chainId==null?!1:!(this.networks?.map(t=>t.chainId)?.includes(this.chainId?.toString())??!1)}get network(){let t=this.chainId?.toString()??this.params?.defaultNetworkId?.toString();return this.networks?.find(e=>e.type==="tvm"&&e.chainId===t)}get providerInfo(){return this.providers?.find(t=>t.id===this.providerId)?.info}get providers(){return this.params?.providers??[]}get account(){return this.connector?.account}get chainId(){return this.connector?.chainId}get isConnecting(){return this.connector?.isConnecting}get isDisconnecting(){return this.connector?.isDisconnecting}get isInitialized(){return this.connector?.isInitialized}get isInitializing(){return this.connector?.isInitializing}async syncContractState(t){if(!(!this.provider||!t?.force&&this.isSyncing))try{if(this.account?.address){this.setState("isSyncing",this.isSyncing===void 0);let e=await Et(this.provider,this.account.address,{force:t?.force});this.setData("contractState",e)}}catch(e){throw(0,S.groupCollapsed)(`%c${this.constructor.name}%c get account full contract state error`,K,C),(0,S.error)(e),(0,S.groupEnd)(),e}finally{this.setState("isSyncing",!1)}}async _init(){this.accountDisposer=(0,d.reaction)(()=>this.address,async(t,e)=>{if(z(t,e)||this.setState("isSyncing",void 0),t){try{await this.watch()}catch{await this.unwatch()}await this.syncContractState({force:!this.isSyncing})}},{equals:d.comparer.shallow}),this.networkDisposer=(0,d.reaction)(()=>this.chainId,async(t,e)=>{if((t!==e||!e)&&(this.setState("isSyncing",void 0),this.address)){try{await this.watch()}catch{await this.unwatch()}await this.syncContractState({force:!0})}})}async watch(){if(!this.provider||!this.address){await this.unwatch();return}await this.unwatch(),this.contractSubscriber=new this.provider.Subscriber,await this.contractSubscriber.states(this.address).delayed(t=>((0,S.debug)(`%c${this.constructor.name}%c subscribes to the user wallet [%c${(0,S.sliceAddress)(this.address?.toString())}%c] contract updates`,Q,C,W,C),t.on(async e=>{(0,S.debug)(`%c${this.constructor.name}%c %ccontractStateChanged%c event was captured for current connected wallet %c${(0,S.sliceAddress)(this.address?.toString())}`,Q,C,W,C,W,e),z(this.address,e.address)?await this.syncContractState({force:!this.isSyncing}):(await this.contractSubscriber?.unsubscribe(),this.contractSubscriber=void 0)})))}async unwatch(){try{await this.contractSubscriber?.unsubscribe(),(0,S.debug)(`%c${this.constructor.name}%c unsubscribe from the user wallet [%c${(0,S.sliceAddress)(this.address?.toString())}%c] contract updates`,Q,C,W,C),this.contractSubscriber=void 0}catch{this.contractSubscriber=void 0}}accountDisposer;contractSubscriber;networkDisposer};l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"connector",null);l([d.action.bound,s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",Promise)],p.prototype,"init",null);l([d.action.bound,s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Promise)],p.prototype,"connect",null);l([d.action.bound,s("design:type",Function),s("design:paramtypes",[Boolean]),s("design:returntype",Promise)],p.prototype,"disconnect",null);l([d.action.bound,s("design:type",Function),s("design:paramtypes",[Object,String]),s("design:returntype",Promise)],p.prototype,"addAsset",null);l([d.action.bound,s("design:type",Function),s("design:paramtypes",[Object,Boolean]),s("design:returntype",Promise)],p.prototype,"addNetwork",null);l([d.action.bound,s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Promise)],p.prototype,"switchNetwork",null);l([d.computed,s("design:type",pt.ProviderRpcClient),s("design:paramtypes",[])],p.prototype,"connection",null);l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"provider",null);l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"contract",null);l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"networks",null);l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"isSyncing",null);l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"providerId",null);l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"address",null);l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"balance",null);l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"currency",null);l([d.computed,s("design:type",Boolean),s("design:paramtypes",[])],p.prototype,"hasProvider",null);l([d.computed,s("design:type",Boolean),s("design:paramtypes",[])],p.prototype,"isConnected",null);l([d.computed,s("design:type",Boolean),s("design:paramtypes",[])],p.prototype,"isOutdated",null);l([d.computed,s("design:type",Boolean),s("design:paramtypes",[])],p.prototype,"isReady",null);l([d.computed,s("design:type",Boolean),s("design:paramtypes",[])],p.prototype,"isUnsupportedNetwork",null);l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"network",null);l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"providerInfo",null);l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"providers",null);l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"account",null);l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"chainId",null);l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"isConnecting",null);l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"isDisconnecting",null);l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"isInitialized",null);l([d.computed,s("design:type",Object),s("design:paramtypes",[])],p.prototype,"isInitializing",null);l([d.action.bound,s("design:type",Function),s("design:paramtypes",[Object]),s("design:returntype",Promise)],p.prototype,"syncContractState",null);l([d.action.bound,s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",Promise)],p.prototype,"_init",null);l([d.action.bound,s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",Promise)],p.prototype,"watch",null);l([d.action.bound,s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",Promise)],p.prototype,"unwatch",null);var P=require("mobx"),G=require("@broxus/js-utils");var Lt=require("@broxus/js-utils");var kt='data:image/svg+xml,<svg width="1200" height="1200" viewBox="0 0 1200 1200" fill="none" xmlns="http://www.w3.org/2000/svg">%0A    <path d="M1200 600C1200 268.629 931.371 0 600 0C268.629 0 0 268.629 0 600C0 931.371 268.629 1200 600 1200C931.371 1200 1200 931.371 1200 600Z" fill="%23050B2E"/>%0A    <path d="M459.298 300L187.5 574.793H629.323V1012.5L900 741.632V300H459.298Z" fill="%23C5E4F3"/>%0A</svg>%0A';var jt='data:image/svg+xml,<svg width="1200" height="1200" viewBox="0 0 1200 1200" fill="none" xmlns="http://www.w3.org/2000/svg">%0A    <g clip-path="url(%23clip0_465_2)">%0A        <g filter="url(%23filter0_d_465_2)">%0A            <rect x="20" y="20" width="1160" height="1160" rx="580" fill="%230F1224"/>%0A            <path d="M309.86 842.504L267.058 799.702L377.252 689.508C426.589 640.172 426.589 559.884 377.252 510.548L267 400.296L309.802 357.494L420.054 467.746C492.995 540.687 492.995 659.369 420.054 732.31L309.86 842.504Z" fill="url(%23paint0_linear_465_2)"/>%0A            <path d="M799.702 933L689.508 822.806C640.172 773.47 559.885 773.47 510.549 822.806L400.354 933L357.552 890.198L467.747 780.004C540.688 707.063 659.369 707.063 732.31 780.004L842.504 890.198L799.702 933Z" fill="url(%23paint1_linear_465_2)"/>%0A            <path d="M890.198 842.504L780.004 732.31C707.063 659.369 707.063 540.688 780.004 467.747L890.198 357.552L933 400.354L822.806 510.549C773.47 559.885 773.47 640.172 822.806 689.508L933 799.702L890.198 842.504Z" fill="url(%23paint2_linear_465_2)"/>%0A            <path d="M600.019 474.765C552.114 474.765 504.208 456.535 467.747 420.055L357.495 309.802L400.297 267L510.549 377.253C559.885 426.589 640.173 426.589 689.509 377.253L799.703 267.058L842.505 309.86L732.311 420.055C695.83 456.515 647.944 474.765 600.039 474.765H600.019Z" fill="url(%23paint3_linear_465_2)"/>%0A        </g>%0A    </g>%0A    <defs>%0A        <filter id="filter0_d_465_2" x="-25" y="-25" width="1250" height="1250" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">%0A            <feFlood flood-opacity="0" result="BackgroundImageFix"/>%0A            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>%0A            <feOffset/>%0A            <feGaussianBlur stdDeviation="22.5"/>%0A            <feComposite in2="hardAlpha" operator="out"/>%0A            <feColorMatrix type="matrix" values="0 0 0 0 0.164706 0 0 0 0 0.741176 0 0 0 0 0.894118 0 0 0 0.1 0"/>%0A            <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_465_2"/>%0A            <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_465_2" result="shape"/>%0A        </filter>%0A        <linearGradient id="paint0_linear_465_2" x1="370.873" y1="839.875" x2="370.873" y2="360.955" gradientUnits="userSpaceOnUse">%0A            <stop stop-color="%2300B2E3" stop-opacity="0"/>%0A            <stop offset="0.07" stop-color="%2305B3E3" stop-opacity="0.03"/>%0A            <stop offset="0.19" stop-color="%2313B7E3" stop-opacity="0.13"/>%0A            <stop offset="0.33" stop-color="%232ABDE4" stop-opacity="0.28"/>%0A            <stop offset="0.49" stop-color="%234AC5E5" stop-opacity="0.49"/>%0A            <stop offset="0.66" stop-color="%2373D0E6" stop-opacity="0.75"/>%0A            <stop offset="0.81" stop-color="%239ADBE8"/>%0A        </linearGradient>%0A        <linearGradient id="paint1_linear_465_2" x1="840.687" y1="829.147" x2="358.461" y2="829.147" gradientUnits="userSpaceOnUse">%0A            <stop stop-color="%2300B2E3" stop-opacity="0"/>%0A            <stop offset="0.07" stop-color="%2305B3E3" stop-opacity="0.03"/>%0A            <stop offset="0.19" stop-color="%2313B7E3" stop-opacity="0.13"/>%0A            <stop offset="0.33" stop-color="%232ABDE4" stop-opacity="0.28"/>%0A            <stop offset="0.49" stop-color="%234AC5E5" stop-opacity="0.49"/>%0A            <stop offset="0.66" stop-color="%2373D0E6" stop-opacity="0.75"/>%0A            <stop offset="0.81" stop-color="%239ADBE8"/>%0A        </linearGradient>%0A        <linearGradient id="paint2_linear_465_2" x1="829.147" y1="358.326" x2="829.147" y2="837.033" gradientUnits="userSpaceOnUse">%0A            <stop stop-color="%2300B2E3" stop-opacity="0"/>%0A            <stop offset="0.07" stop-color="%2305B3E3" stop-opacity="0.03"/>%0A            <stop offset="0.19" stop-color="%2313B7E3" stop-opacity="0.13"/>%0A            <stop offset="0.33" stop-color="%232ABDE4" stop-opacity="0.28"/>%0A            <stop offset="0.49" stop-color="%234AC5E5" stop-opacity="0.49"/>%0A            <stop offset="0.66" stop-color="%2373D0E6" stop-opacity="0.75"/>%0A            <stop offset="0.81" stop-color="%239ADBE8"/>%0A        </linearGradient>%0A        <linearGradient id="paint3_linear_465_2" x1="356.296" y1="370.873" x2="842.776" y2="370.873" gradientUnits="userSpaceOnUse">%0A            <stop stop-color="%2300B2E3" stop-opacity="0"/>%0A            <stop offset="0.07" stop-color="%2305B3E3" stop-opacity="0.03"/>%0A            <stop offset="0.19" stop-color="%2313B7E3" stop-opacity="0.13"/>%0A            <stop offset="0.33" stop-color="%232ABDE4" stop-opacity="0.28"/>%0A            <stop offset="0.49" stop-color="%234AC5E5" stop-opacity="0.49"/>%0A            <stop offset="0.66" stop-color="%2373D0E6" stop-opacity="0.75"/>%0A            <stop offset="0.81" stop-color="%239ADBE8"/>%0A        </linearGradient>%0A        <clipPath id="clip0_465_2">%0A            <rect width="1200" height="1200" fill="white"/>%0A        </clipPath>%0A    </defs>%0A</svg>%0A';var Tt='data:image/svg+xml,<svg width="1200" height="1200" viewBox="0 0 1200 1200" fill="none" xmlns="http://www.w3.org/2000/svg">%0A    <path d="M600 1200C931.371 1200 1200 931.371 1200 600C1200 268.629 931.371 0 600 0C268.629 0 0 268.629 0 600C0 931.371 268.629 1200 600 1200Z" fill="%234C5AF5"/>%0A    <path d="M878.122 238.043C855.787 234.439 832.901 236.491 811.575 244.007C790.245 251.525 771.157 264.266 756.071 281.058C727.275 313.2 718.316 355.045 725.231 396.979C731.494 434.794 739.804 473.175 741.675 509.606C744.289 564.476 735.904 619.313 717.011 670.924C699.915 717.619 675.559 753.833 623.362 761.846C619.492 762.454 605.4 762.885 601.395 763.103C597.394 763.32 584.737 762.495 580.822 761.891C528.626 753.878 504.052 717.664 487.001 670.661C468.105 619.054 459.724 564.214 462.337 509.344C464.209 473.044 472.515 434.621 478.777 396.716C485.696 354.785 476.734 312.94 447.941 280.798C432.806 264.018 413.67 251.306 392.302 243.833C370.932 236.361 348.017 234.369 325.671 238.043C258.729 248.916 214.145 308.088 213.754 370.163C213.567 394.08 220.09 417.574 232.588 438C253.423 472.223 287.611 497.171 317.45 523.076C337.197 540.405 371.343 589.571 388.087 642.851C398.224 675.124 406.489 707.828 414.664 740.839C426.15 786.84 441.937 888.465 452.332 934.601C473.081 1026.96 536.587 1047.88 600.221 1050H602.482C666.12 1047.88 730.669 1026.91 751.417 934.556C761.767 888.424 777.514 786.754 789.086 740.794C797.306 707.959 805.526 675.079 815.662 642.81C832.406 589.526 866.554 540.188 886.301 523.035C916.14 497.044 950.284 472.178 971.164 437.955C983.659 417.533 990.184 394.039 989.996 370.12C989.647 307.915 945.236 248.699 878.122 238.043Z" fill="white"/>%0A</svg>%0A';var nt=()=>({connector:new U,id:"SparXWallet",info:{description:"Your universal tool for TVM",icon:jt,links:{android:"https://play.google.com/store/apps/details?id=com.broxus.sparx.app",homepage:"https://sparxwallet.com/",chromeExtension:"https://chrome.google.com/webstore/detail/sparx-wallet/aijecocmefcagpmbpjcfjjbcclfmobgf",ios:"https://apps.apple.com/us/app/sparx-tvm-wallet/id6670219321",universalLink:Rt("https://l.sparxwallet.com",{apn:"com.broxus.sparx.app",ibi:"app.sparx.broxus.com",isi:"6670219321"})},name:"SparX Wallet"}}),lt=()=>({connector:new V,id:"EverWallet",info:{description:"Premier wallet for the Everscale",icon:kt,links:{android:"https://play.google.com/store/apps/details?id=com.broxus.crystal.app",chromeExtension:"https://chrome.google.com/webstore/detail/ever-wallet/cgeeodpfagjceefieflmdfphplkenlfk",firefoxExtension:"https://addons.mozilla.org/en-GB/firefox/addon/ever-wallet/",homepage:"https://everwallet.net/",ios:"https://apps.apple.com/us/app/ever-wallet-everscale/id1581310780"},name:"Ever Wallet"}}),ut=()=>({connector:new Z,id:"VenomWallet",info:{description:"Safe, reliable, and 100% yours",icon:Tt,links:{android:"https://play.google.com/store/apps/details?id=com.venom.wallet",chromeExtension:"https://chrome.google.com/webstore/detail/venom-wallet/ojggmchlghnjlapmfbnjholfjkiidbch",homepage:"https://venomwallet.com/",ios:"https://apps.apple.com/app/venom-blockchain-wallet/id1622970889",universalLink:Rt("https://venomwallet.page.link",{apn:"com.venom.wallet",ibi:"foundation.venom.wallet",isi:"1622970889"})},name:"Venom Wallet"}});function Rt(i,t){return[i,(0,Lt.paramsSerializer)({apn:t.apn,ibi:t.ibi,isi:t.isi,link:t.link||encodeURIComponent(window.location.href)})].join("?")}var se={connection:{type:"jrpc",data:{endpoint:"https://jrpc.everwallet.net"}},name:"Everscale",networkId:42,config:{symbol:"EVER",explorerBaseUrl:"https://everscan.io",tokensManifestUrl:"https://raw.githubusercontent.com/broxus/ton-assets/master/manifest.json"}},ae={connection:{type:"jrpc",data:{endpoint:"https://jrpc.venom.foundation"}},name:"Everscale",networkId:1,config:{symbol:"VENOM",explorerBaseUrl:"https://venomscan.com",tokensManifestUrl:"https://cdn.venom.foundation/assets/mainnet/manifest.json"}},ce={connection:{type:"proto",data:{endpoint:"https://rpc.hamster.network"}},name:"Hamster Network",networkId:7,config:{explorerBaseUrl:"http://hamsterscan.io",tokensManifestUrl:"https://raw.githubusercontent.com/broxus/ton-assets/refs/heads/hmstr/manifest.json",symbol:"HMSTR"}},de={connection:{type:"proto",data:{endpoint:"https://rpc-testnet.tychoprotocol.com/proto"}},name:"Tycho Testnet",networkId:2e3,config:{explorerBaseUrl:"https://testnet.tychoprotocol.com",tokensManifestUrl:"https://raw.githubusercontent.com/broxus/ton-assets/refs/heads/tychotestnet/manifest.json",symbol:"TYCHO"}},pe={connection:{type:"jrpc",data:{endpoint:"https://jrpc-ton.broxus.com"}},name:"TON",networkId:-239,config:{explorerBaseUrl:"https://tonviewer.com",tokensManifestUrl:"https://raw.githubusercontent.com/broxus/ton-assets/refs/heads/ton-prod/manifest.json",symbol:"TON"}};var le={id:42,type:"jrpc",data:{endpoint:"https://jrpc.everwallet.net"}},ue={id:1,type:"jrpc",data:{endpoint:"https://jrpc.venom.foundation"}},he={id:7,type:"jrpc",data:{endpoint:"https://rpc.hamster.network"}},me={id:2e3,type:"jrpc",data:{endpoint:"https://rpc-testnet.tychoprotocol.com"}},fe={id:-239,type:"jrpc",data:{endpoint:"https://jrpc-ton.broxus.com"}};var mt=class{constructor(t){this.params=t;this.root=document.createElement("div"),this.root.classList.add("tvm-connect-ui-root"),document.body.append(this.root);let e=it(),n=[],r="",o=(0,G.getUserAgent)();if(xt(o)){let a=lt();r=a.id,n.push(a)}if(Nt(o)){let a=nt();r=a.id,n.push(a)}if(Mt(o)){let a=ut();r=a.id,n.push(a)}if(!n.length){let a=t.providers;r=a?.length===1?a[0].id:e?.providerId,n=a?.length?a:[nt()]}this.tvmWallet=new p({autoInit:!0,providers:n,providerId:r}),this.hasProvider=Object.fromEntries(this.tvmWallet.providers.map(a=>[a.id,!1])),(0,P.makeAutoObservable)(this,{},{autoBind:!0}),(0,P.reaction)(()=>this.tvmWallet.providers.map(a=>a.connector.provider),this.syncHasProvider,{fireImmediately:!0}),(0,P.reaction)(()=>this.state,()=>{this.subscribers.forEach(a=>{a(this.state)})},{fireImmediately:!0}),(0,P.reaction)(()=>this.tvmWallet.chainId,this.syncNetworkId,{fireImmediately:!0}),(0,P.autorun)(()=>{this.render()})}itemTemplate=t=>{let e=this.hasProvider[t.id],n=this.isInitializing[t.id],r=t.info.links?.homepage,o=t.info.links?.universalLink,[a,u]=_t({...t.info.links})??[],T=it();return h.html` ${!e&&n?h.html`<button class=${(0,ht.classMap)({"tvm-connect-ui-item":!0,"tvm-connect-ui-item-disabled":!0})} >${t.info.icon?h.html`<img class="tvm-connect-ui-item-icon" src=${t.info.icon} alt="" />`:null}<div class="tvm-connect-ui-item-info"><div class="tvm-connect-ui-item-name">${t.info.name}</div><div class="tvm-connect-ui-item-desc">Initializing...</div></div></button>`:this.isMobile&&!e&&o?h.html`<a target="_blank" rel="noopener noreferrer" class="tvm-connect-ui-item" href=${o}>${t.info.icon?h.html`<img class="tvm-connect-ui-item-icon" src=${t.info.icon} alt="" />`:null}<div class="tvm-connect-ui-item-info"><div class="tvm-connect-ui-item-name">${t.info.name}</div>${t.info.description?h.html`<div class="tvm-connect-ui-item-desc">${t.info.description}</div>`:null}</div></a>`:e?h.html`<button class="tvm-connect-ui-item" @click=${this.selectProvider.bind(this,t.id)}>${t.info.icon?h.html`<img class="tvm-connect-ui-item-icon" src=${t.info.icon} alt="" />`:null}<div class="tvm-connect-ui-item-info"><div class="tvm-connect-ui-item-name">${t.info.name}</div>${t.info.description?h.html`<div class="tvm-connect-ui-item-desc">${t.info.description}</div>`:null}</div>${this.providerId===t.id?h.html`<div class="tvm-connect-ui-item-label">Connected</div>`:T&&T.providerId===t.id?h.html`<div class="tvm-connect-ui-item-label">Recent</div>`:null}</button>`:h.html`<a target="_blank" rel="noopener noreferrer" class=${(0,ht.classMap)({"tvm-connect-ui-item-disabled":!u&&!r,"tvm-connect-ui-item":!0})} href=${(0,Dt.ifDefined)(u??r)} >${t.info.icon?h.html`<img class="tvm-connect-ui-item-icon" src=${t.info.icon} alt="" />`:null}<div class="tvm-connect-ui-item-info"><div class="tvm-connect-ui-item-name">Install ${t.info.name}</div>${t.info.description?h.html`<div class="tvm-connect-ui-item-desc">${t.info.description}</div>`:null}</div></a>`} `};providerTemplate=()=>{if(!this.selectedProvider)return h.nothing;let t=()=>{this.disconnect(),this.resetselectedProvider()};return h.html`<button tabindex="0" class="tvm-connect-ui-back" @click=${this.resetselectedProvider}><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor" ><path d="m289.18-445.54 214.05 213.8q9.85 10.15 10.23 24.19.39 14.04-9.43 24.41-10.49 10.73-24.7 10.66-14.2-.06-24.02-10.55L186.87-451.47q-6.23-5.56-9-12.54-2.77-6.98-2.77-15.69 0-8.04 2.77-14.99 2.77-6.95 9-12.51l269.77-269.77q10.23-10.23 24.18-10.43 13.95-.19 24.54 10.43 9.82 10.59 9.82 24.34 0 13.76-9.82 23.32L289.18-513.13h478.69q13.87 0 23.66 9.8 9.8 9.8 9.8 23.67 0 14.53-9.8 24.33-9.79 9.79-23.66 9.79H289.18Z" /></svg></button><div class="tvm-connect-ui-provider"><div class="tvm-connect-ui-provider-info">${this.selectedProvider.info.icon?h.html`<img class="tvm-connect-ui-provider-icon" src=${this.selectedProvider.info.icon} alt="" />`:null} ${this.selectedProvider.info.description?h.html`<div class="tvm-connect-ui-provider-desc">${this.selectedProvider.info.description}</div>`:null}</div>${this.providerId===this.selectedProvider.id?h.html`<div class="tvm-connect-ui-provider-status"><div class="tvm-connect-ui-provider-hint">${this.selectedProvider.info.name} is connected </div><button class="tvm-connect-ui-provider-btn" @click=${t}>Disconnect</button></div>`:this.selectedProviderError?h.html`<div class="tvm-connect-ui-provider-status"><div class="tvm-connect-ui-provider-error">Connection failed</div><div class="tvm-connect-ui-provider-text"> The request was rejected, please try again </div><button class="tvm-connect-ui-provider-btn" @click=${this.selectProvider.bind(this,this.selectedProvider.id)} > Try again </button></div>`:h.html`<div class="tvm-connect-ui-provider-status"><div class="tvm-connect-ui-provider-hint"> Continue in ${this.selectedProvider.info.name}</div><div class="tvm-connect-ui-provider-text">Accept connection request in the wallet</div></div>`}</div>`};rootTemplate=()=>{let t=it();return h.html`<div class="tvm-connect-ui-overlay" @click=${this.hide}></div><div class="tvm-connect-ui-popup"><button class="tvm-connect-ui-close" tabindex="0" @click=${this.hide}><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor" ><path d="M480-437.85 277.08-234.92q-8.31 8.3-20.89 8.5-12.57.19-21.27-8.5-8.69-8.7-8.69-21.08 0-12.38 8.69-21.08L437.85-480 234.92-682.92q-8.3-8.31-8.5-20.89-.19-12.57 8.5-21.27 8.7-8.69 21.08-8.69 12.38 0 21.08 8.69L480-522.15l202.92-202.93q8.31-8.3 20.89-8.5 12.57-.19 21.27 8.5 8.69 8.7 8.69 21.08 0 12.38-8.69 21.08L522.15-480l202.93 202.92q8.3 8.31 8.5 20.89.19 12.57-8.5 21.27-8.7 8.69-21.08 8.69-12.38 0-21.08-8.69L480-437.85Z" /></svg></button><div class="tvm-connect-ui-title">Connect a wallet</div>${this.selectedProvider?this.providerTemplate():h.html`<div class="tvm-connect-ui-list">${Array.from(this.tvmWallet.providers).sort((e,n)=>e.id===t?.providerId?-1:n.id===t?.providerId?1:0).map(e=>this.itemTemplate(e))}</div>`}</div>`};tvmWallet;root;visible=!1;selectedProviderId=void 0;selectedNetwork=void 0;hasProvider;isMobile=(0,G.isMobile)((0,G.getUserAgent)());subscribers=[];networkId=void 0;selectedProviderError=void 0;providers=[];resetselectedProvider(){this.selectedProviderId=void 0,this.selectedProviderError=void 0}async selectProvider(t){try{if(this.selectedProviderId=t,this.providerId===t)return;let e=this.tvmWallet.connector,n=this.tvmWallet.providers.find(r=>r.id===t);if(!n)throw new Error("Provider not founded");await n.connector.connect(this.selectedNetwork),this.tvmWallet.providerId&&t!==this.tvmWallet.providerId&&await e?.disconnect(!0),dt({providerId:t,type:n.connector.type}),this.tvmWallet.setState("providerId",t),this.hide()}catch(e){this.selectedProviderError=e,console.error(e)}}async syncHasProvider(){let t=await Promise.all(this.tvmWallet.providers.map(async e=>{try{if(e.connector.provider instanceof Ot.ProviderRpcClient&&typeof e.connector.provider?.hasProvider=="function"){let n=await e.connector.provider.hasProvider();return[e.id,n]}else return[e.id,e.connector.provider!=null]}catch(n){return console.error(n),[e.id,!1]}}));(0,P.runInAction)(()=>{this.hasProvider=Object.fromEntries(t)})}async syncNetworkId(){let t;try{t=(await this.getProvider()?.getProviderState())?.networkId}catch(e){console.error(e)}(0,P.runInAction)(()=>{this.networkId=t})}render(){(0,h.render)(this.rootTemplate(),this.root),this.root.classList.toggle("tvm-connect-ui-root-active",this.visible)}show(){this.resetselectedProvider(),this.visible=!0}hide(){this.visible=!1}get selectedProvider(){return this.tvmWallet.providers.find(t=>t.id===this.selectedProviderId)}get isInitializing(){return Object.fromEntries(this.tvmWallet.providers.map(t=>[t.id,t.connector.isInitializing===void 0||t.connector.isInitializing]))}get balance(){return this.tvmWallet.balance}get providerId(){return this.isReady?this.tvmWallet.providerId:void 0}get address(){return this.tvmWallet.address?.toString()}get account(){return this.tvmWallet.account}get isReady(){return this.tvmWallet.isReady}get isUnsupportedNetwork(){return this.params.networks&&this.params.networks.length>0&&this.networkId!==void 0?this.params.networks.every(t=>t.networkId!==this.networkId):!1}get isLoading(){return!!this.tvmWallet.isInitializing||!!this.tvmWallet.isConnecting}get state(){return{providerId:this.providerId,networkId:this.networkId,account:this.account,address:this.address,balance:this.balance,isReady:this.isReady,isLoading:this.isLoading,isUnsupportedNetwork:this.isUnsupportedNetwork,isPopupVisible:this.visible,isInitializing:this.tvmWallet.isInitializing===!0,isNotInstalled:Object.values(this.isInitializing).every(t=>t===!1)&&Object.values(this.hasProvider).every(t=>t===!1)}}connect(t){if(this.selectedNetwork=t,this.tvmWallet.providers.length>1)this.show();else{let e=this.tvmWallet.providers.at(0);e?this.selectProvider(e.id):console.warn("Provider must be defined")}}disconnect(){this.tvmWallet.disconnect(!0)}switchNetwork(t){return this.tvmWallet.switchNetwork(t)}addNetwork(t){return this.tvmWallet.addNetwork(t)}changeAccount(){return this.tvmWallet.provider?.changeAccount()}getProvider(){return this.tvmWallet.provider}getState(){return{...this.state}}subscribe(t){let e=this.subscribers.push(t);return t(this.getState()),()=>{this.subscribers.splice(e-1,1)}}};
